{% extends 'core/header.html' %}
{% load static %}

{%block perfil%}
<section class="container" style="padding-top: 260px;">
  <div class="row">
    <form class="col-12" id="perfil">
      {% csrf_token %}
      <fieldset>

        <legend>Información Personal:
          <button type="button" class="btn btn-primary float-right" id="informacionPersonal"><i
              class="fas fa-edit">&nbsp;Editar</i></button>
        </legend>

        <div class="form-group">
          <label for="first_name">Nombre(s): </label>
          <input disabled type="text" class="form-control" value="{{perfil.first_name}}" name="nombres" id="nombreP">
        </div>

        <div class="form-group">
          <label for="last_name">Apellido(s): </label>
          <input disabled type="text" class="form-control" value="{{perfil.last_name}}" name="apellidos" id="apellidosP">
        </div>

        <div class="form-group">
          <label for="email">Correo: </label>
          <input disabled type="email" class="form-control" value="{{perfil.email}}" name="correo" id="correoP">
        </div>

        <p>Si desea cambiar contraseña click <a href="{% url 'password_change' %}">aquí.</a></p>
      </fieldset>

      <fieldset>

        <legend>Información Académica:
          <button type="button" class="btn btn-primary float-right mb-2" id="informacionAcademica"><i
              class="fas fa-edit">&nbsp;Editar</i></button>
        </legend>

        <div class="form-group">

          <label for="">Categoría:</label>
          <select disabled class="form-control mb-2" name="categoria" id="categoria">
            <option selected value="{{ perfil.nombramiento}}">
              {% if perfil.nombramiento %}{{perfil.nombramiento}}{% else %}Sin especificar{%endif%}</option>
            <option value="Investigador posdoctoral">Investigador posdoctoral</option>
            <option value="Cátedra CONACyT">Cátedra CONACyT</option>
            <option value="Investigador Asociado C">Investigador Asociado C</option>
            <option value="Investigador Titular A">Investigador Titular A</option>
            <option value="Investigador Titular B">Investigador Titular B</option>
            <option value="Investigador Titular C">Investigador Titular C</option>
            <option value="Investigador Titular D">Investigador Titular D</option>
          </select>

          <label for="">Nivel SNI:</label>
          <select disabled class="form-control mb-2" name="nivel_sni" id="nivel_sni">
            <option selected value="{{perfil.nivelSni}}">{% if perfil.nivelSni %}{{perfil.nivelSni}}{% else %}Sin
              Nombramiento{% endif %}</option>
            <option value="Candidato">Candidato</option>
            <option value="Nivel 1">Nivel 1</option>
            <option value="Nivel 2">Nivel 2</option>
            <option value="Nivel 3">Nivel 3</option>
            <option value="Emérito">Emérito</option>
          </select>

          <label for="ORCID">ORCID</label>
          <input disabled type="text" class="form-control mb-2" placeholder="Escriba su ORCID"
            value="{% if perfil.orcID %}{{perfil.orcId}}{% endif %}" name="orc_id" id="orc_id">

          <label for="">ArXiv ID</label>
          <input disabled type="text" class="form-control mb-2" placeholder="Escriba su ArXiv ID"
            value="{% if perfil.arxivId %}{{perfil.arxivId}}{% endif %}" name="arxiv_id" id="arxiv_id">

          <button  disabled id="guardarPerfil" onclick="actualizarPerfil()" type="button" class="btn mt-2 mb-2 float-right btn-success"><i class="fas fa-save">
              &nbsp; Guardar Cambios</i></button>
        </div>
      </fieldset>


    </form>
  </div>
  <div class="w-100 pb-2"></div>

</section>

{%endblock%}


{% block JsCode %}
<script>
  function actualizarPerfil() {
    var formData = new FormData(document.getElementById("perfil"));
    
    $.ajax({
      type: 'POST',
      url: "{% url 'registration:actualizar-perfil' %}",
      data: formData,
      enctype: "multipart/form-data",
      cache: false,
      contentType: false,
      processData: false,
      dataType: "html",
      success: function (response) {
        toastr.success("Perfil actualizado correctamente","Operación exitosa")
      }
    });
    return false;
  }

</script>
{% endblock %}
